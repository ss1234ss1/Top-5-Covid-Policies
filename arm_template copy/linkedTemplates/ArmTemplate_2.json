{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "factoryName": {
            "type": "string",
            "metadata": "Data Factory name",
            "defaultValue": "ds310Team7Covid19"
        }
    },
    "variables": {
        "factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
    },
    "resources": [
        {
            "name": "[concat(parameters('factoryName'), '/countries_dataflow')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "azuresql_country_copy1",
                                "type": "DatasetReference"
                            },
                            "name": "countrysource"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "geography_parquet",
                                "type": "DatasetReference"
                            },
                            "name": "countrysink",
                            "rejectedDataLinkedService": {
                                "referenceName": "challenge2",
                                "type": "LinkedServiceReference"
                            }
                        }
                    ],
                    "transformations": [],
                    "scriptLines": [
                        "source(output(",
                        "          Country as string,",
                        "          CountryCode as string,",
                        "          Latitude as decimal(10,5),",
                        "          Longitude as decimal(10,5)",
                        "     ),",
                        "     allowSchemaDrift: true,",
                        "     validateSchema: false,",
                        "     ignoreNoFilesFound: false,",
                        "     format: 'parquet') ~> countrysource",
                        "countrysource sink(allowSchemaDrift: true,",
                        "     validateSchema: false,",
                        "     format: 'parquet',",
                        "     partitionFileNames:['geography.parquet'],",
                        "     umask: 0022,",
                        "     preCommands: [],",
                        "     postCommands: [],",
                        "     skipDuplicateMapInputs: true,",
                        "     skipDuplicateMapOutputs: true,",
                        "     partitionBy('hash', 1)) ~> countrysink"
                    ]
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/covid19metrics_dataflow')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "azuresql_covid19metrics",
                                "type": "DatasetReference"
                            },
                            "name": "azurecovid19metricsdataflow"
                        },
                        {
                            "dataset": {
                                "referenceName": "sqlserver_covid19metrics",
                                "type": "DatasetReference"
                            },
                            "name": "sqlcovid19metricsdataflow"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "cases_parquet",
                                "type": "DatasetReference"
                            },
                            "name": "sinkcases",
                            "rejectedDataLinkedService": {
                                "referenceName": "challenge2",
                                "type": "LinkedServiceReference"
                            }
                        },
                        {
                            "dataset": {
                                "referenceName": "recoveries_parquet",
                                "type": "DatasetReference"
                            },
                            "name": "sinkrecoveries",
                            "rejectedDataLinkedService": {
                                "referenceName": "challenge2",
                                "type": "LinkedServiceReference"
                            }
                        },
                        {
                            "dataset": {
                                "referenceName": "deaths_parquet",
                                "type": "DatasetReference"
                            },
                            "name": "sinkdeaths",
                            "rejectedDataLinkedService": {
                                "referenceName": "challenge2",
                                "type": "LinkedServiceReference"
                            }
                        }
                    ],
                    "transformations": [
                        {
                            "name": "union"
                        },
                        {
                            "name": "selectcases"
                        },
                        {
                            "name": "selectrecoveries"
                        },
                        {
                            "name": "selectdeaths"
                        },
                        {
                            "name": "derivedcolumndeaths"
                        },
                        {
                            "name": "derivedcolumnrecoveries"
                        },
                        {
                            "name": "derivedcolumncases"
                        }
                    ],
                    "scriptLines": [
                        "source(output(",
                        "          ID as integer,",
                        "          Updated as date,",
                        "          Confirmed as integer,",
                        "          Confirmed_Change as integer,",
                        "          Deaths as integer,",
                        "          Deaths_Change as integer,",
                        "          Recovered as integer,",
                        "          Recovered_Change as integer,",
                        "          Latitude as decimal(10,5),",
                        "          Longitude as decimal(10,5),",
                        "          ISO2 as string,",
                        "          ISO3 as string,",
                        "          Country_Region as string,",
                        "          load_time as timestamp",
                        "     ),",
                        "     allowSchemaDrift: true,",
                        "     validateSchema: false,",
                        "     ignoreNoFilesFound: false,",
                        "     format: 'parquet') ~> azurecovid19metricsdataflow",
                        "source(output(",
                        "          ID as integer,",
                        "          Updated as date,",
                        "          Confirmed as integer,",
                        "          Confirmed_Change as integer,",
                        "          Deaths as integer,",
                        "          Deaths_Change as integer,",
                        "          Recovered as integer,",
                        "          Recovered_Change as integer,",
                        "          Latitude as decimal(10,5),",
                        "          Longitude as decimal(10,5),",
                        "          ISO2 as string,",
                        "          ISO3 as string,",
                        "          Country_Region as string,",
                        "          load_time as timestamp",
                        "     ),",
                        "     allowSchemaDrift: true,",
                        "     validateSchema: false,",
                        "     ignoreNoFilesFound: false,",
                        "     format: 'parquet') ~> sqlcovid19metricsdataflow",
                        "azurecovid19metricsdataflow, sqlcovid19metricsdataflow union(byName: true)~> union",
                        "union select(mapColumn(",
                        "          ID,",
                        "          Updated,",
                        "          Confirmed,",
                        "          Confirmed_Change,",
                        "          Latitude,",
                        "          Longitude,",
                        "          ISO2,",
                        "          ISO3,",
                        "          Country_Region,",
                        "          load_time",
                        "     ),",
                        "     skipDuplicateMapInputs: true,",
                        "     skipDuplicateMapOutputs: true) ~> selectcases",
                        "union select(mapColumn(",
                        "          ID,",
                        "          Updated,",
                        "          Recovered,",
                        "          Recovered_Change,",
                        "          Latitude,",
                        "          Longitude,",
                        "          ISO2,",
                        "          ISO3,",
                        "          Country_Region,",
                        "          load_time",
                        "     ),",
                        "     skipDuplicateMapInputs: true,",
                        "     skipDuplicateMapOutputs: true) ~> selectrecoveries",
                        "union select(mapColumn(",
                        "          ID,",
                        "          Updated,",
                        "          Death = Deaths,",
                        "          Deaths_Change,",
                        "          Latitude,",
                        "          Longitude,",
                        "          ISO2,",
                        "          ISO3,",
                        "          Country_Region,",
                        "          load_time",
                        "     ),",
                        "     skipDuplicateMapInputs: true,",
                        "     skipDuplicateMapOutputs: true) ~> selectdeaths",
                        "selectdeaths derive(SID = concat(toString(Updated), ISO3)) ~> derivedcolumndeaths",
                        "selectrecoveries derive(SID = concat(toString(Updated), ISO3)) ~> derivedcolumnrecoveries",
                        "selectcases derive(SID = concat(toString(Updated), ISO3)) ~> derivedcolumncases",
                        "derivedcolumncases sink(allowSchemaDrift: true,",
                        "     validateSchema: false,",
                        "     input(",
                        "          CountryName as string,",
                        "          CountryCode as string,",
                        "          RegionName as string,",
                        "          RegionCode as string,",
                        "          Jurisdiction as string,",
                        "          Date as timestamp,",
                        "          C1_School_closing as long,",
                        "          C1_Flag as double,",
                        "          C2_Workplace_closing as long,",
                        "          C2_Flag as double,",
                        "          C3_Cancel_public_events as double,",
                        "          C3_Flag as double,",
                        "          C4_Restrictions_on_gatherings as double,",
                        "          C4_Flag as double,",
                        "          C5_Close_public_transport as double,",
                        "          C5_Flag as double,",
                        "          C6_Stay_at_home_requirements as double,",
                        "          C6_Flag as double,",
                        "          C7_Restrictions_on_internal_movement as double,",
                        "          C7_Flag as double,",
                        "          C8_International_travel_controls as double,",
                        "          E1_Income_support as long,",
                        "          E1_Flag as double,",
                        "          E2_Debt_contract_relief as double,",
                        "          E3_Fiscal_measures as double,",
                        "          E4_International_support as double,",
                        "          H1_Public_information_campaigns as double,",
                        "          H1_Flag as double,",
                        "          H2_Testing_policy as double,",
                        "          H3_Contact_tracing as double,",
                        "          H4_Emergency_investment_in_healthcare as double,",
                        "          H5_Investment_in_vaccines as double,",
                        "          H6_Facial_Coverings as double,",
                        "          H6_Flag as double,",
                        "          H7_Vaccination_policy as double,",
                        "          H7_Flag as double,",
                        "          H8_Protection_of_elderly_people as double,",
                        "          H8_Flag as double,",
                        "          M1_Wildcard as double,",
                        "          StringencyIndex as double,",
                        "          StringencyIndexForDisplay as double,",
                        "          StringencyLegacyIndex as double,",
                        "          StringencyLegacyIndexForDisplay as double,",
                        "          GovernmentResponseIndex as double,",
                        "          GovernmentResponseIndexForDisplay as double,",
                        "          ContainmentHealthIndex as double,",
                        "          ContainmentHealthIndexForDisplay as double,",
                        "          EconomicSupportIndex as double,",
                        "          EconomicSupportIndexForDisplay as double,",
                        "          id as string,",
                        "          {_rid} as string,",
                        "          {_self} as string,",
                        "          {_etag} as string,",
                        "          {_attachments} as string,",
                        "          {_ts} as long",
                        "     ),",
                        "     format: 'parquet',",
                        "     partitionFileNames:['cases.parquet'],",
                        "     umask: 0022,",
                        "     preCommands: [],",
                        "     postCommands: [],",
                        "     skipDuplicateMapInputs: true,",
                        "     skipDuplicateMapOutputs: true,",
                        "     partitionBy('hash', 1)) ~> sinkcases",
                        "derivedcolumnrecoveries sink(allowSchemaDrift: true,",
                        "     validateSchema: false,",
                        "     format: 'parquet',",
                        "     partitionFileNames:['recoveries.parquet'],",
                        "     umask: 0022,",
                        "     preCommands: [],",
                        "     postCommands: [],",
                        "     skipDuplicateMapInputs: true,",
                        "     skipDuplicateMapOutputs: true,",
                        "     partitionBy('hash', 1)) ~> sinkrecoveries",
                        "derivedcolumndeaths sink(allowSchemaDrift: true,",
                        "     validateSchema: false,",
                        "     format: 'parquet',",
                        "     partitionFileNames:['deaths.parquet'],",
                        "     umask: 0022,",
                        "     preCommands: [],",
                        "     postCommands: [],",
                        "     skipDuplicateMapInputs: true,",
                        "     skipDuplicateMapOutputs: true,",
                        "     partitionBy('hash', 1)) ~> sinkdeaths"
                    ]
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/policy_dataflow')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "Parquet12",
                                "type": "DatasetReference"
                            },
                            "name": "policydataflow"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "cosmos_policy_parquet",
                                "type": "DatasetReference"
                            },
                            "name": "sinkpolicy",
                            "rejectedDataLinkedService": {
                                "referenceName": "challenge2",
                                "type": "LinkedServiceReference"
                            }
                        }
                    ],
                    "transformations": [
                        {
                            "name": "derivedColumn1"
                        }
                    ],
                    "scriptLines": [
                        "source(output(",
                        "          CountryName as string,",
                        "          CountryCode as string,",
                        "          RegionName as string,",
                        "          RegionCode as string,",
                        "          Jurisdiction as string,",
                        "          Date as timestamp,",
                        "          C1_School_closing as long,",
                        "          C1_Flag as double,",
                        "          C2_Workplace_closing as long,",
                        "          C2_Flag as double,",
                        "          C3_Cancel_public_events as double,",
                        "          C3_Flag as double,",
                        "          C4_Restrictions_on_gatherings as double,",
                        "          C4_Flag as double,",
                        "          C5_Close_public_transport as double,",
                        "          C5_Flag as double,",
                        "          C6_Stay_at_home_requirements as double,",
                        "          C6_Flag as double,",
                        "          C7_Restrictions_on_internal_movement as double,",
                        "          C7_Flag as double,",
                        "          C8_International_travel_controls as double,",
                        "          E1_Income_support as long,",
                        "          E1_Flag as double,",
                        "          E2_Debt_contract_relief as double,",
                        "          E3_Fiscal_measures as double,",
                        "          E4_International_support as double,",
                        "          H1_Public_information_campaigns as double,",
                        "          H1_Flag as double,",
                        "          H2_Testing_policy as double,",
                        "          H3_Contact_tracing as double,",
                        "          H4_Emergency_investment_in_healthcare as double,",
                        "          H5_Investment_in_vaccines as double,",
                        "          H6_Facial_Coverings as double,",
                        "          H6_Flag as double,",
                        "          H7_Vaccination_policy as double,",
                        "          H7_Flag as double,",
                        "          H8_Protection_of_elderly_people as double,",
                        "          H8_Flag as double,",
                        "          M1_Wildcard as double,",
                        "          StringencyIndex as double,",
                        "          StringencyIndexForDisplay as double,",
                        "          StringencyLegacyIndex as double,",
                        "          StringencyLegacyIndexForDisplay as double,",
                        "          GovernmentResponseIndex as double,",
                        "          GovernmentResponseIndexForDisplay as double,",
                        "          ContainmentHealthIndex as double,",
                        "          ContainmentHealthIndexForDisplay as double,",
                        "          EconomicSupportIndex as double,",
                        "          EconomicSupportIndexForDisplay as double,",
                        "          id as string,",
                        "          {_rid} as string,",
                        "          {_self} as string,",
                        "          {_etag} as string,",
                        "          {_attachments} as string,",
                        "          {_ts} as long",
                        "     ),",
                        "     allowSchemaDrift: true,",
                        "     validateSchema: false,",
                        "     ignoreNoFilesFound: false,",
                        "     format: 'parquet') ~> policydataflow",
                        "policydataflow derive(SID = concat(toString(Date), CountryCode)) ~> derivedColumn1",
                        "derivedColumn1 sink(allowSchemaDrift: true,",
                        "     validateSchema: false,",
                        "     format: 'parquet',",
                        "     partitionFileNames:['policy.parquet'],",
                        "     umask: 0022,",
                        "     preCommands: [],",
                        "     postCommands: [],",
                        "     skipDuplicateMapInputs: true,",
                        "     skipDuplicateMapOutputs: true,",
                        "     partitionBy('hash', 1)) ~> sinkpolicy"
                    ]
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/datesdataflow')]",
            "type": "Microsoft.DataFactory/factories/dataflows",
            "apiVersion": "2018-06-01",
            "properties": {
                "type": "MappingDataFlow",
                "typeProperties": {
                    "sources": [
                        {
                            "dataset": {
                                "referenceName": "sqlserver_dates",
                                "type": "DatasetReference"
                            },
                            "name": "datessource"
                        }
                    ],
                    "sinks": [
                        {
                            "dataset": {
                                "referenceName": "dates_parquet",
                                "type": "DatasetReference"
                            },
                            "name": "datessink",
                            "rejectedDataLinkedService": {
                                "referenceName": "challenge2",
                                "type": "LinkedServiceReference"
                            }
                        }
                    ],
                    "transformations": [
                        {
                            "name": "datesselect"
                        }
                    ],
                    "scriptLines": [
                        "source(output(",
                        "          Country as string,",
                        "          CountryCode as string,",
                        "          Latitude as decimal(10,5),",
                        "          Longitude as decimal(10,5),",
                        "          ID as integer,",
                        "          Updated as date,",
                        "          Confirmed as integer,",
                        "          Confirmed_Change as integer,",
                        "          Deaths as integer,",
                        "          Deaths_Change as integer,",
                        "          Recovered as integer,",
                        "          Recovered_Change as integer,",
                        "          ISO2 as string,",
                        "          ISO3 as string,",
                        "          Country_Region as string,",
                        "          load_time as timestamp,",
                        "          DateKey as integer,",
                        "          FullDate as date,",
                        "          isWeekDay as boolean,",
                        "          DayOfWeek as integer,",
                        "          DayOfMonth as integer,",
                        "          DayOfQuarter as integer,",
                        "          DayOfYear as integer,",
                        "          DayName as string,",
                        "          WeekOfYear as integer,",
                        "          WeekName as string,",
                        "          MonthOfYear as integer,",
                        "          MonthName as string,",
                        "          CalendarQuarter as integer,",
                        "          CalendarQuarterName as string,",
                        "          CalendarYear as integer,",
                        "          FiscalMonth as integer,",
                        "          FiscalMonthName as string,",
                        "          FiscalQuarter as integer,",
                        "          FiscalQuarterName as string,",
                        "          FiscalYear as integer",
                        "     ),",
                        "     allowSchemaDrift: true,",
                        "     validateSchema: false,",
                        "     ignoreNoFilesFound: false,",
                        "     format: 'parquet') ~> datessource",
                        "datessource select(mapColumn(",
                        "          DateKey,",
                        "          FullDate,",
                        "          isWeekDay,",
                        "          DayOfWeek,",
                        "          DayOfMonth,",
                        "          DayOfQuarter,",
                        "          DayOfYear,",
                        "          DayName,",
                        "          WeekOfYear,",
                        "          WeekName,",
                        "          MonthOfYear,",
                        "          MonthName,",
                        "          CalendarQuarter,",
                        "          CalendarQuarterName,",
                        "          CalendarYear,",
                        "          FiscalMonth,",
                        "          FiscalMonthName,",
                        "          FiscalQuarter,",
                        "          FiscalQuarterName,",
                        "          FiscalYear",
                        "     ),",
                        "     skipDuplicateMapInputs: true,",
                        "     skipDuplicateMapOutputs: true) ~> datesselect",
                        "datesselect sink(allowSchemaDrift: true,",
                        "     validateSchema: false,",
                        "     input(",
                        "          DateKey as integer,",
                        "          FullDate as date,",
                        "          isWeekDay as boolean,",
                        "          DayOfWeek as integer,",
                        "          DayOfMonth as integer,",
                        "          DayOfQuarter as integer,",
                        "          DayOfYear as integer,",
                        "          DayName as string,",
                        "          WeekOfYear as integer,",
                        "          WeekName as string,",
                        "          MonthOfYear as integer,",
                        "          MonthName as string,",
                        "          CalendarQuarter as integer,",
                        "          CalendarQuarterName as string,",
                        "          CalendarYear as integer,",
                        "          FiscalMonth as integer,",
                        "          FiscalMonthName as string,",
                        "          FiscalQuarter as integer,",
                        "          FiscalQuarterName as string,",
                        "          FiscalYear as integer",
                        "     ),",
                        "     format: 'parquet',",
                        "     partitionFileNames:['dates.parquet'],",
                        "     umask: 0022,",
                        "     preCommands: [],",
                        "     postCommands: [],",
                        "     skipDuplicateMapInputs: true,",
                        "     skipDuplicateMapOutputs: true,",
                        "     partitionBy('hash', 1)) ~> datessink"
                    ]
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/pipeline2')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Copy data1",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "CosmosDbSqlApiSource",
                                "preferredRegions": []
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "path": "$['CountryName']"
                                        },
                                        "sink": {
                                            "name": "CountryName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['CountryCode']"
                                        },
                                        "sink": {
                                            "name": "CountryCode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['RegionName']"
                                        },
                                        "sink": {
                                            "name": "RegionName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['RegionCode']"
                                        },
                                        "sink": {
                                            "name": "RegionCode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['Jurisdiction']"
                                        },
                                        "sink": {
                                            "name": "Jurisdiction",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['Date']"
                                        },
                                        "sink": {
                                            "name": "Date",
                                            "type": "Date"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C1_School closing']"
                                        },
                                        "sink": {
                                            "name": "C1_School closing",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C1_Flag']"
                                        },
                                        "sink": {
                                            "name": "C1_Flag",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C2_Workplace closing']"
                                        },
                                        "sink": {
                                            "name": "C2_Workplace closing",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C2_Flag']"
                                        },
                                        "sink": {
                                            "name": "C2_Flag",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C3_Cancel public events']"
                                        },
                                        "sink": {
                                            "name": "C3_Cancel public events",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C3_Flag']"
                                        },
                                        "sink": {
                                            "name": "C3_Flag",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C4_Restrictions on gatherings']"
                                        },
                                        "sink": {
                                            "name": "C4_Restrictions on gatherings",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C4_Flag']"
                                        },
                                        "sink": {
                                            "name": "C4_Flag",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C5_Close public transport']"
                                        },
                                        "sink": {
                                            "name": "C5_Close public transport",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C5_Flag']"
                                        },
                                        "sink": {
                                            "name": "C5_Flag",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C6_Stay at home requirements']"
                                        },
                                        "sink": {
                                            "name": "C6_Stay at home requirements",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C6_Flag']"
                                        },
                                        "sink": {
                                            "name": "C6_Flag",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C7_Restrictions on internal movement']"
                                        },
                                        "sink": {
                                            "name": "C7_Restrictions on internal movement",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C7_Flag']"
                                        },
                                        "sink": {
                                            "name": "C7_Flag",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C8_International travel controls']"
                                        },
                                        "sink": {
                                            "name": "C8_International travel controls",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['E1_Income support']"
                                        },
                                        "sink": {
                                            "name": "E1_Income support",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['E1_Flag']"
                                        },
                                        "sink": {
                                            "name": "E1_Flag",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['E2_Debt contract relief']"
                                        },
                                        "sink": {
                                            "name": "E2_Debt contract relief",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['E3_Fiscal measures']"
                                        },
                                        "sink": {
                                            "name": "E3_Fiscal measures",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['E4_International support']"
                                        },
                                        "sink": {
                                            "name": "E4_International support",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H1_Public information campaigns']"
                                        },
                                        "sink": {
                                            "name": "H1_Public information campaigns",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H1_Flag']"
                                        },
                                        "sink": {
                                            "name": "H1_Flag",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H2_Testing policy']"
                                        },
                                        "sink": {
                                            "name": "H2_Testing policy",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H3_Contact tracing']"
                                        },
                                        "sink": {
                                            "name": "H3_Contact tracing",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H4_Emergency investment in healthcare']"
                                        },
                                        "sink": {
                                            "name": "H4_Emergency investment in healthcare",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H5_Investment in vaccines']"
                                        },
                                        "sink": {
                                            "name": "H5_Investment in vaccines",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H6_Facial Coverings']"
                                        },
                                        "sink": {
                                            "name": "H6_Facial Coverings",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H6_Flag']"
                                        },
                                        "sink": {
                                            "name": "H6_Flag",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H7_Vaccination policy']"
                                        },
                                        "sink": {
                                            "name": "H7_Vaccination policy",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H7_Flag']"
                                        },
                                        "sink": {
                                            "name": "H7_Flag",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H8_Protection of elderly people']"
                                        },
                                        "sink": {
                                            "name": "H8_Protection of elderly people",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H8_Flag']"
                                        },
                                        "sink": {
                                            "name": "H8_Flag",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['M1_Wildcard']"
                                        },
                                        "sink": {
                                            "name": "M1_Wildcard",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['StringencyIndex']"
                                        },
                                        "sink": {
                                            "name": "StringencyIndex",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['StringencyIndexForDisplay']"
                                        },
                                        "sink": {
                                            "name": "StringencyIndexForDisplay",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['StringencyLegacyIndex']"
                                        },
                                        "sink": {
                                            "name": "StringencyLegacyIndex",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['StringencyLegacyIndexForDisplay']"
                                        },
                                        "sink": {
                                            "name": "StringencyLegacyIndexForDisplay",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['GovernmentResponseIndex']"
                                        },
                                        "sink": {
                                            "name": "GovernmentResponseIndex",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['GovernmentResponseIndexForDisplay']"
                                        },
                                        "sink": {
                                            "name": "GovernmentResponseIndexForDisplay",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['ContainmentHealthIndex']"
                                        },
                                        "sink": {
                                            "name": "ContainmentHealthIndex",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['ContainmentHealthIndexForDisplay']"
                                        },
                                        "sink": {
                                            "name": "ContainmentHealthIndexForDisplay",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['EconomicSupportIndex']"
                                        },
                                        "sink": {
                                            "name": "EconomicSupportIndex",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['EconomicSupportIndexForDisplay']"
                                        },
                                        "sink": {
                                            "name": "EconomicSupportIndexForDisplay",
                                            "type": "Double"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "CosmosDbNoSqlContainer1",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Parquet4",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-03-28T20:37:52Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/cosmosdb')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Copy data1",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "CosmosDbSqlApiSource",
                                "preferredRegions": []
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "path": "$['CountryName']"
                                        },
                                        "sink": {
                                            "name": "CountryName"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['CountryCode']"
                                        },
                                        "sink": {
                                            "name": "CountryCode"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['RegionName']"
                                        },
                                        "sink": {
                                            "name": "RegionName",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['RegionCode']"
                                        },
                                        "sink": {
                                            "name": "RegionCode",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['Jurisdiction']"
                                        },
                                        "sink": {
                                            "name": "Jurisdiction"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['Date']"
                                        },
                                        "sink": {
                                            "name": "Date"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C1_School closing']"
                                        },
                                        "sink": {
                                            "name": "C1_School_closing"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C1_Flag']"
                                        },
                                        "sink": {
                                            "name": "C1_Flag",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C2_Workplace closing']"
                                        },
                                        "sink": {
                                            "name": "C2_Workplace_closing"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C2_Flag']"
                                        },
                                        "sink": {
                                            "name": "C2_Flag",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C3_Cancel public events']"
                                        },
                                        "sink": {
                                            "name": "C3_Cancel_public_events",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C3_Flag']"
                                        },
                                        "sink": {
                                            "name": "C3_Flag",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C4_Restrictions on gatherings']"
                                        },
                                        "sink": {
                                            "name": "C4_Restrictions_on_gatherings",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C4_Flag']"
                                        },
                                        "sink": {
                                            "name": "C4_Flag",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C5_Close public transport']"
                                        },
                                        "sink": {
                                            "name": "C5_Close_public_transport",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C5_Flag']"
                                        },
                                        "sink": {
                                            "name": "C5_Flag",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C6_Stay at home requirements']"
                                        },
                                        "sink": {
                                            "name": "C6_Stay_at_home_requirements",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C6_Flag']"
                                        },
                                        "sink": {
                                            "name": "C6_Flag",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C7_Restrictions on internal movement']"
                                        },
                                        "sink": {
                                            "name": "C7_Restrictions_on_internal_movement",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C7_Flag']"
                                        },
                                        "sink": {
                                            "name": "C7_Flag",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['C8_International travel controls']"
                                        },
                                        "sink": {
                                            "name": "C8_International_travel_controls",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['E1_Income support']"
                                        },
                                        "sink": {
                                            "name": "E1_Income_support"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['E1_Flag']"
                                        },
                                        "sink": {
                                            "name": "E1_Flag",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['E2_Debt contract relief']"
                                        },
                                        "sink": {
                                            "name": "E2_Debt_contract_relief",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['E3_Fiscal measures']"
                                        },
                                        "sink": {
                                            "name": "E3_Fiscal_measures",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['E4_International support']"
                                        },
                                        "sink": {
                                            "name": "E4_International_support",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H1_Public information campaigns']"
                                        },
                                        "sink": {
                                            "name": "H1_Public_information_campaigns",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H1_Flag']"
                                        },
                                        "sink": {
                                            "name": "H1_Flag",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H2_Testing policy']"
                                        },
                                        "sink": {
                                            "name": "H2_Testing_policy",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H3_Contact tracing']"
                                        },
                                        "sink": {
                                            "name": "H3_Contact_tracing",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H4_Emergency investment in healthcare']"
                                        },
                                        "sink": {
                                            "name": "H4_Emergency_investment_in_healthcare",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H5_Investment in vaccines']"
                                        },
                                        "sink": {
                                            "name": "H5_Investment_in_vaccines",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H6_Facial Coverings']"
                                        },
                                        "sink": {
                                            "name": "H6_Facial_Coverings",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H6_Flag']"
                                        },
                                        "sink": {
                                            "name": "H6_Flag",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H7_Vaccination policy']"
                                        },
                                        "sink": {
                                            "name": "H7_Vaccination_policy",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H7_Flag']"
                                        },
                                        "sink": {
                                            "name": "H7_Flag",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H8_Protection of elderly people']"
                                        },
                                        "sink": {
                                            "name": "H8_Protection_of_elderly_people",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['H8_Flag']"
                                        },
                                        "sink": {
                                            "name": "H8_Flag",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['M1_Wildcard']"
                                        },
                                        "sink": {
                                            "name": "M1_Wildcard",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['StringencyIndex']"
                                        },
                                        "sink": {
                                            "name": "StringencyIndex",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['StringencyIndexForDisplay']"
                                        },
                                        "sink": {
                                            "name": "StringencyIndexForDisplay",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['StringencyLegacyIndex']"
                                        },
                                        "sink": {
                                            "name": "StringencyLegacyIndex",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['StringencyLegacyIndexForDisplay']"
                                        },
                                        "sink": {
                                            "name": "StringencyLegacyIndexForDisplay",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['GovernmentResponseIndex']"
                                        },
                                        "sink": {
                                            "name": "GovernmentResponseIndex",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['GovernmentResponseIndexForDisplay']"
                                        },
                                        "sink": {
                                            "name": "GovernmentResponseIndexForDisplay",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['ContainmentHealthIndex']"
                                        },
                                        "sink": {
                                            "name": "ContainmentHealthIndex",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['ContainmentHealthIndexForDisplay']"
                                        },
                                        "sink": {
                                            "name": "ContainmentHealthIndexForDisplay",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['EconomicSupportIndex']"
                                        },
                                        "sink": {
                                            "name": "EconomicSupportIndex",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['EconomicSupportIndexForDisplay']"
                                        },
                                        "sink": {
                                            "name": "EconomicSupportIndexForDisplay",
                                            "type": "Double"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['id']"
                                        },
                                        "sink": {
                                            "name": "id"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['_rid']"
                                        },
                                        "sink": {
                                            "name": "_rid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['_self']"
                                        },
                                        "sink": {
                                            "name": "_self"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['_etag']"
                                        },
                                        "sink": {
                                            "name": "_etag"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['_attachments']"
                                        },
                                        "sink": {
                                            "name": "_attachments"
                                        }
                                    },
                                    {
                                        "source": {
                                            "path": "$['_ts']"
                                        },
                                        "sink": {
                                            "name": "_ts"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "CosmosDbNoSqlContainer1",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "Parquet12",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-04-15T22:42:58Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/azuresql_pipeline')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Copy data1",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "country_azuresqltable",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "azuresql_country",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy data2",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "ID",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "ID",
                                            "type": "Int32",
                                            "physicalType": "INT_32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Updated",
                                            "type": "DateTime",
                                            "physicalType": "date"
                                        },
                                        "sink": {
                                            "name": "Updated",
                                            "type": "DateTime",
                                            "physicalType": "INT_96"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Confirmed",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "Confirmed",
                                            "type": "Int32",
                                            "physicalType": "INT_32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Confirmed_Change",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "Confirmed_Change",
                                            "type": "Int32",
                                            "physicalType": "INT_32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Deaths",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "Deaths",
                                            "type": "Int32",
                                            "physicalType": "INT_32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Deaths_Change",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "Deaths_Change",
                                            "type": "Int32",
                                            "physicalType": "INT_32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Recovered",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "Recovered",
                                            "type": "Int32",
                                            "physicalType": "INT_32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Recovered_Change",
                                            "type": "Int32",
                                            "physicalType": "int"
                                        },
                                        "sink": {
                                            "name": "Recovered_Change",
                                            "type": "Int32",
                                            "physicalType": "INT_32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Latitude",
                                            "type": "Decimal",
                                            "physicalType": "decimal",
                                            "scale": 5,
                                            "precision": 10
                                        },
                                        "sink": {
                                            "name": "Latitude",
                                            "type": "Decimal",
                                            "physicalType": "DECIMAL"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Longitude",
                                            "type": "Decimal",
                                            "physicalType": "decimal",
                                            "scale": 5,
                                            "precision": 10
                                        },
                                        "sink": {
                                            "name": "Longitude",
                                            "type": "Decimal",
                                            "physicalType": "DECIMAL"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ISO2",
                                            "type": "String",
                                            "physicalType": "varchar"
                                        },
                                        "sink": {
                                            "name": "ISO2",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "ISO3",
                                            "type": "String",
                                            "physicalType": "varchar"
                                        },
                                        "sink": {
                                            "name": "ISO3",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "Country_Region",
                                            "type": "String",
                                            "physicalType": "varchar"
                                        },
                                        "sink": {
                                            "name": "Country_Region",
                                            "type": "String",
                                            "physicalType": "UTF8"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "load_time",
                                            "type": "DateTime",
                                            "physicalType": "datetime"
                                        },
                                        "sink": {
                                            "name": "load_time",
                                            "type": "DateTime",
                                            "physicalType": "INT_96"
                                        }
                                    }
                                ],
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "covid19metrics_azuresqltable",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "azuresql_covid19metrics",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy data3",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "dates_azuresqltable",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "azuresql_dates",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-04-07T19:01:55Z"
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/covid19metrics_sqlservertable')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "SqlServer2",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "SqlServerTable",
                "schema": [
                    {
                        "name": "ID",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "Updated",
                        "type": "date"
                    },
                    {
                        "name": "Confirmed",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "Confirmed_Change",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "Deaths",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "Deaths_Change",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "Recovered",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "Recovered_Change",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "Latitude",
                        "type": "decimal",
                        "precision": 10,
                        "scale": 5
                    },
                    {
                        "name": "Longitude",
                        "type": "decimal",
                        "precision": 10,
                        "scale": 5
                    },
                    {
                        "name": "ISO2",
                        "type": "varchar"
                    },
                    {
                        "name": "ISO3",
                        "type": "varchar"
                    },
                    {
                        "name": "Country_Region",
                        "type": "varchar"
                    },
                    {
                        "name": "load_time",
                        "type": "datetime",
                        "precision": 23,
                        "scale": 3
                    }
                ],
                "typeProperties": {
                    "schema": "dbo",
                    "table": "Covid19_Metrics"
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/dates_sqlservertable')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "SqlServer3",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "SqlServerTable",
                "schema": [
                    {
                        "name": "DateKey",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "FullDate",
                        "type": "date"
                    },
                    {
                        "name": "isWeekDay",
                        "type": "bit"
                    },
                    {
                        "name": "DayOfWeek",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "DayOfMonth",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "DayOfQuarter",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "DayOfYear",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "DayName",
                        "type": "varchar"
                    },
                    {
                        "name": "WeekOfYear",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "WeekName",
                        "type": "varchar"
                    },
                    {
                        "name": "MonthOfYear",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "MonthName",
                        "type": "varchar"
                    },
                    {
                        "name": "CalendarQuarter",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "CalendarQuarterName",
                        "type": "varchar"
                    },
                    {
                        "name": "CalendarYear",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "FiscalMonth",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "FiscalMonthName",
                        "type": "varchar"
                    },
                    {
                        "name": "FiscalQuarter",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "FiscalQuarterName",
                        "type": "varchar"
                    },
                    {
                        "name": "FiscalYear",
                        "type": "int",
                        "precision": 10
                    }
                ],
                "typeProperties": {
                    "schema": "dbo",
                    "table": "Dates"
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/country_sqlservertable')]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "2018-06-01",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "SqlServer1",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "SqlServerTable",
                "schema": [],
                "typeProperties": {
                    "schema": "dbo",
                    "table": "Country"
                }
            },
            "dependsOn": []
        },
        {
            "name": "[concat(parameters('factoryName'), '/sqlserver_pipeline')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "Copy data1",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "country_sqlservertable",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sqlserver_country",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy data2",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "covid19metrics_sqlservertable",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sqlserver_covid19metrics",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "Copy data3",
                        "type": "Copy",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "queryTimeout": "02:00:00",
                                "partitionOption": "None"
                            },
                            "sink": {
                                "type": "ParquetSink",
                                "storeSettings": {
                                    "type": "AzureBlobFSWriteSettings"
                                },
                                "formatSettings": {
                                    "type": "ParquetWriteSettings"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "typeConversion": true,
                                "typeConversionSettings": {
                                    "allowDataTruncation": true,
                                    "treatBooleanAsNumber": false
                                }
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "dates_sqlservertable",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "sqlserver_dates",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-04-07T19:01:55Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/datasets/country_sqlservertable')]",
                "[concat(variables('factoryId'), '/datasets/covid19metrics_sqlservertable')]",
                "[concat(variables('factoryId'), '/datasets/dates_sqlservertable')]"
            ]
        },
        {
            "name": "[concat(parameters('factoryName'), '/challenge2_dataflows')]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "2018-06-01",
            "properties": {
                "activities": [
                    {
                        "name": "covid19metricsdataflow",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "covid19metrics_dataflow",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "azurecovid19metricsdataflow": {},
                                    "sqlcovid19metricsdataflow": {},
                                    "sinkcases": {},
                                    "sinkrecoveries": {},
                                    "sinkdeaths": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "countriesdataflow",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "countries_dataflow",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "countrysource": {},
                                    "countrysink": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "datesdataflow",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "datesdataflow",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "datessource": {},
                                    "datessink": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    },
                    {
                        "name": "policydataflow",
                        "type": "ExecuteDataFlow",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "0.12:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataflow": {
                                "referenceName": "policy_dataflow",
                                "type": "DataFlowReference",
                                "parameters": {},
                                "datasetParameters": {
                                    "policydataflow": {},
                                    "sinkpolicy": {}
                                }
                            },
                            "staging": {},
                            "compute": {
                                "coreCount": 8,
                                "computeType": "General"
                            },
                            "traceLevel": "Fine"
                        }
                    }
                ],
                "policy": {
                    "elapsedTimeMetric": {}
                },
                "annotations": [],
                "lastPublishTime": "2024-04-07T19:01:55Z"
            },
            "dependsOn": [
                "[concat(variables('factoryId'), '/dataflows/covid19metrics_dataflow')]",
                "[concat(variables('factoryId'), '/dataflows/countries_dataflow')]",
                "[concat(variables('factoryId'), '/dataflows/datesdataflow')]",
                "[concat(variables('factoryId'), '/dataflows/policy_dataflow')]"
            ]
        }
    ]
}